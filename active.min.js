function wait(e){for(var t=(new Date).getTime(),n=t;n<t+e;)n=(new Date).getTime()}function hidesplash(){try{document.getElementById("splash").classList.add("hide")}catch{console.log("No splash exists")}}function deactivate(){try{const e=document.getElementsByClassName("active");for(const t of e)t.classList.remove("active")}catch{console.log("Could not deactivate as no file")}}function getMenus(e){fetch(e).then(e=>e.text()).then(e=>{csvFile=e,document.getElementById("footer").innerText="";const t=csvFile.split("\n");var n,o,a="",l="x";t.forEach(e=>{const t=e.split(",");let c,d,s;c=t[0].trim(),d=t[1].trim(),s=t[2].trim(),n="</details>",o=s.charAt(0),null==c||""===c||("c"===o&&(a+="<a id='"+c+"' class='menuitem' href='#'>"+d+"</a>"),"o"===o&&"c"!==l&&(a+="<a id='"+c+"' class='menuitem' href='#'>"+d+"</a>"),"o"===o&&"c"===l&&(a+=n+"<a id='"+c+"' class='menuitem' href='#'>"+d+"</a>"),"p"===o&&"c"!==l&&(a+="<details><summary>"+d+"</summary>"),"p"===o&&"c"===l&&(a+=n+"<details><summary>"+d+"</summary>"),l=o)}),e=a,document.getElementById("items").innerHTML="<div id='menu' class='sidebar fakecontent'>"+e+"</div>"}).then(e=>{try{let e=document.querySelectorAll(".menuitem");e.forEach(function(e){e.addEventListener("click",function(){saveem(this.id)})})}catch{console.log("event listeners not loaded as no file")}}).catch(e=>console.log("Failed to load menu"),document.getElementById("footer").innerText="Menu file not loaded",document.getElementById("settings").classList.remove("hide"))}function getMarkdown(e){fetch(e).then(e=>e.text()).then(e=>{!0===isBase64(e)?(console.log("Encrypted file"),console.log("b64: "+e),console.log("file is base64"),e=atob(decrypt(e,localStorage.getItem("papEkey"))),wait(1e3)):console.log("Unencrypted MD file");const t=Systemm.render(e),n=document.getElementById("niv");n.innerHTML=t,document.getElementById("footer").innerText=""}).catch(e=>{console.log("Failed to load files or another error"),document.getElementById("settings").classList.remove("hide"),console.error(e)});let t=document.querySelectorAll(".menuitem");t.forEach(function(e){e.addEventListener("click",function(){saveem(this.id)})})}async function saveem(e){hidesplash(),document.getElementById("thesettings").classList.add("hide");const t=document.getElementsByClassName("showme");for(const e of t)e.classList.add("hideme"),e.classList.remove("showme");deactivate();var n=document.getElementById(e);try{n.className="active"}catch{console.log("could not add class")}n=document.getElementById("t"+e);try{n.className="showme";var o=new Date;localStorage.setItem(e,o)}catch{console.log("could not add class")}}function functionrefresh(){location.reload()}fetch(md).then(e=>e.blob()).then(e=>{const t=new File([e],e.name);console.log(t.lastModifiedDate,t.lastModified),localStorage.setItem("papLastMod",t.lastModifiedDate)}).catch(e=>console.log("Failed to find date of file")),getMenus(mu),getMarkdown(md);var button=document.getElementById("burger");button.onclick=function(){var e=document.querySelector(".item2");e.classList.toggle("hide");var t=document.getElementById("thebody");t.classList.toggle("col2")};button=document.getElementById("dots");button.onclick=function(){function e(){var e=document.getElementById("i1").value;localStorage.setItem("pap",e)}function t(){var e=document.getElementById("i2").value;localStorage.setItem("papIndex",e)}function n(){var e=document.getElementById("i4").value;localStorage.setItem("papAPI",e)}function n(){var e=document.getElementById("i5").value;localStorage.setItem("papEkey",e)}function o(){var e=document.getElementById("i6").value;localStorage.setItem("logo",e)}try{const e=document.getElementsByClassName("showme");for(const t of e)t.classList.add("hideme"),t.classList.remove("showme"),document.getElementById("footer").innerText=""}catch{console.log("Couldnt hide as no file found")}document.getElementById("footer").innerText="",hidesplash(),deactivate(),document.getElementById("savecontainer").classList.add("hide"),document.getElementById("thesettings").classList.remove("hide"),document.getElementById("i1").value=localStorage.getItem("pap"),document.getElementById("i2").value=localStorage.getItem("papIndex"),document.getElementById("i3").value=localStorage.getItem("papLastMod"),document.getElementById("i4").value=localStorage.getItem("papAPI"),document.getElementById("i5").value=localStorage.getItem("papEkey"),document.getElementById("i6").value=localStorage.getItem("logo"),document.getElementById("i1").addEventListener("keyup",e),document.getElementById("i2").addEventListener("keyup",t),document.getElementById("i4").addEventListener("keyup",n),document.getElementById("i5").addEventListener("keyup",n),document.getElementById("i6").addEventListener("keyup",o)},document.getElementById("refresh").addEventListener("click",functionrefresh),document.addEventListener("DOMContentLoaded",function(e){document.querySelectorAll("img").forEach(function(e){e.onerror=function(){this.style.display="none"}})});var helpbutton=document.getElementById("help");helpbutton.onclick=function(){var e="help.md",t="help.csv";document.getElementById("footer").innerText="",getMarkdown(e),getMenus(t),document.getElementById("splash").innerHTML="";try{document.getElementById("splash").classList.remove("hide")}catch{console.log("No splash exists")}},document.addEventListener("animationstart",function(e){"fade-in"===e.animationName&&e.target.classList.add("did-fade-in")}),document.addEventListener("animationend",function(e){"fade-out"===e.animationName&&e.target.classList.remove("did-fade-in")});